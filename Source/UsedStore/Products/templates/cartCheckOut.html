{% load static %}
<!DOCTYPE html>
<html lang="en">

    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Z-Store</title>
        <!-- plugins:css -->
        <link rel="stylesheet" href="{% static 'vendors/feather/feather.css' %}">
        <link rel="stylesheet" href="{% static 'vendors/ti-icons/css/themify-icons.css' %}">
        <link rel="stylesheet" href="{% static 'vendors/css/vendor.bundle.base.css' %}">
        <!-- endinject -->
        <!-- Plugin css for this page -->
        <link rel="stylesheet" href="{% static 'vendors/datatables.net-bs4/dataTables.bootstrap4.css' %}">
        <link rel="stylesheet" href="{% static 'vendors/ti-icons/css/themify-icons.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'js/select.dataTables.min.css' %}">
        <link rel="stylesheet" href="{' static 'vendors/mdi/css/materialdesignicons.min.css' %}">
        <link rel="stylesheet" href="{' static 'vendors/mdi/css/materialdesignicons.min.css' %}">
        <!-- End plugin css for this page -->
        <!-- inject:css -->
        <link rel="stylesheet" href="{% static 'css/vertical-layout-light/style.css' %}">
        <!-- endinject -->
        <link rel="shortcut icon" href="{% static 'images/Custom Logo/i2.png' %}" />
        <!-- Custom Styling -->
        <link rel="stylesheet" href="https://cdn.materialdesignicons.com/5.5.55/css/materialdesignicons.min.css">

        <style>
            .cardImage {
                height: 100%;
                width: 100%;
                object-fit: cover;
            }

            .cardDetail {
                display: inline-block;
                margin-left: 5px;
            }
        </style>
        <!-- End of Custom Styling -->
    </head>

    <body>
        <div class="container-scroller">
            <!-- partial:partials/_navbar.html -->
            <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
                <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
                    <a class="navbar-brand brand-logo mr-5" href="{% url 'index' %}"><img
                            src="{% static 'images/Custom Logo/p2.png' %}" class="mr-2" alt="logo" /></a>
                    <a class="navbar-brand brand-logo-mini" href="{% url 'index' %}"><img
                            src="{% static 'images/logo-mini.svg' %}" alt="logo" /></a>
                </div>
                <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
                    <!-- <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
          <span class="icon-menu"></span>
        </button> -->
                    <ul class="navbar-nav mr-lg-2">
                        <li class="nav-item nav-search d-none d-lg-block">
                            <div class="input-group">
                                <div class="input-group-prepend hover-cursor" id="navbar-search-icon">
                                    <span class="input-group-text" id="search">
                                        <i class="icon-search"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" id="navbar-search-input"
                                    placeholder="Search now" aria-label="search" aria-describedby="search">
                            </div>
                        </li>
                    </ul>
                    <ul class="navbar-nav navbar-nav-right">
                        <!-- <li class="nav-item dropdown">
            <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#" data-toggle="dropdown">
              <i class="icon-bell mx-0"></i>
              <span class="count"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
              <p class="mb-0 font-weight-normal float-left dropdown-header">Notifications</p>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-success">
                    <i class="ti-info-alt mx-0"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <h6 class="preview-subject font-weight-normal">Application Error</h6>
                  <p class="font-weight-light small-text mb-0 text-muted">
                    Just now
                  </p>
                </div>
              </a>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-warning">
                    <i class="ti-settings mx-0"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <h6 class="preview-subject font-weight-normal">Settings</h6>
                  <p class="font-weight-light small-text mb-0 text-muted">
                    Private message
                  </p>
                </div>
              </a>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-info">
                    <i class="ti-user mx-0"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <h6 class="preview-subject font-weight-normal">New user registration</h6>
                  <p class="font-weight-light small-text mb-0 text-muted">
                    2 days ago
                  </p>
                </div>
              </a>
            </div>
          </li> -->
                        {% if not user.username %}
                        <li class="nav-item nav-profile dropdown">
                            <a href="{% url 'signup' %}" class="btn btn-primary">SIGN UP</a>
                            <a href="{% url 'signin' %}" class="btn btn-primary" style="margin-left: 10px;">SIGN IN</a>
                        </li>
                        {% else %}
                        <li class="nav-item nav-profile dropdown">
                            <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" id="profileDropdown">
                                <a href="{% url 'addProducts' %}" class="btn btn-inverse-success p-2">Sell Product</a>
                            </a>
                        </li>
                        {% if userauth.userRole == 1 %}
                        <li class="nav-item nav-profile dropdown">
                            <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" id="profileDropdown">
                                <a href="{% url 'adminPy' %}" class="nav-link">
                                    <i class="mdi mdi-airplane text-primary"></i>
                                    Admin Dashboard
                                </a>
                            </a>
                        </li>
                        {% endif %}
                        <li class="nav-item nav-profile dropdown">
                            <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" id="profileDropdown">
                                <h4 style="display: inline-block; font-weight: 900; justify-content: center;"
                                    class="mr-2">
                                    {{userdata.fullname}}
                                </h4>
                                {% if userdata.profileImage %}
                                <img src="{{userdata.profileImage.url}}" alt="profile" />
                                {% else %}
                                <img src="{% static 'images/faces/avatar.jpeg' %}" alt="profile" />
                                {% endif %}
                            </a>
                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown"
                                aria-labelledby="profileDropdown">
                                <a class="dropdown-item" href="{% url 'settings' %}">
                                    <i class="ti-settings text-primary"></i>
                                    Settings
                                </a>
                                <a class="dropdown-item" href="{% url 'userLogout' %}">
                                    <i class="ti-power-off text-primary"></i>
                                    Logout
                                </a>
                            </div>
                        </li>
                        {% endif %}
                        <!-- <li class="nav-item nav-profile dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" id="profileDropdown">
              <img src="images/faces/face28.jpg" alt="profile"/>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="profileDropdown">
              <a class="dropdown-item">
                <i class="ti-settings text-primary"></i>
                Settings
              </a>
              <a class="dropdown-item">
                <i class="ti-power-off text-primary"></i>
                Logout
              </a>
            </div>
          </li> -->
                        <!-- <li class="nav-item nav-settings d-none d-lg-flex">
            <a class="nav-link" href="#">
              <i class="icon-ellipsis"></i>
            </a>
          </li> -->
                    </ul>
                    <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
                        data-toggle="offcanvas">
                        <span class="icon-menu"></span>
                    </button>
                </div>
            </nav>
            <!-- partial -->
            <div class="container-fluid page-body-wrapper">
                <!-- partial:partials/_settings-panel.html -->
                <div id="right-sidebar" class="settings-panel">
                    <i class="settings-close ti-close"></i>
                    <ul class="nav nav-tabs border-top" id="setting-panel" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="todo-tab" data-toggle="tab" href="#todo-section" role="tab"
                                aria-controls="todo-section" aria-expanded="true">TO DO LIST</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="chats-tab" data-toggle="tab" href="#chats-section" role="tab"
                                aria-controls="chats-section">CHATS</a>
                        </li>
                    </ul>

                </div>
                <!-- partial -->
                <!-- partial:partials/_sidebar.html -->
                <!-- Side Bar Here -->
                <!-- partial -->
                <div class="main-panel" style="width: 100vw;">
                    <div class="content-wrapper">
                        <div class="container">
                            <div class="py-5 text-center">
                                <h2>Checkout form</h2>
                            </div>
                            <div class="row">
                                <div class="col-md-4 order-md-2 mb-4">
                                    <h4 class="d-flex justify-content-between align-items-center mb-3">
                                        <span class="text-muted">Your cart</span>
                                        <span class="badge badge-secondary badge-pill">{{data.cartcount}}</span>
                                    </h4>
                                    <ul class="list-group mb-3">
                                        {% for i in data.usercart_set.all %}
                                        <li class="list-group-item d-flex justify-content-between lh-condensed">
                                            <div>
                                                <h6 class="my-0">{{i.product.name}}</h6>
                                            </div>
                                            <span class="text-muted">&#x20B9; {{ i.product.price|floatformat:"2" }}</span>
                                        </li>
                                        {% endfor %}
                                        <li class="list-group-item d-flex justify-content-between">
                                            <span>Total (INR)</span>
                                            <strong>&#x20B9; {{ data.totalAmount|floatformat:"2" }}</strong>
                                        </li>
                                    </ul>
                                </div>

                                <div class="col-md-8 order-md-1">
                                    <h4 class="mb-3">Billing address</h4>
                                    {% if userloca.address_mode > 1 %}
                                    <h5 class="mb-3" id="headeraddre">New Address</h5>
                                    {% else %}
                                    <h5 class="mb-3" id="headeraddre">Default Address</h5>
                                    {% endif %}
                                    <div class="row mb-3">
                                        <div class="col-sm-6">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h5 class="card-title">{{user.username}}</h5>
                                                    <p class="card-text" id="addressText">{{userloca.address}},
                                                        {{userloca.street}},
                                                        {{userloca.city}}, {{userloca.state}}, {{userloca.country}}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-primary" data-toggle="modal"
                                        data-target="#addAddressModal">
                                        Add Address
                                    </button>

                                    <button type="button" class="btn btn-primary" data-toggle="modal"
                                        data-target="#selAddressModal">
                                        Select Another Address
                                    </button>

                                    <!-- Modal -->
                                    <div class="modal fade" id="addAddressModal" tabindex="-1" role="dialog"
                                        aria-labelledby="addAddressModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="addAddressModalLabel">Add New Address
                                                    </h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <!-- Your address form goes here -->
                                                    <form action="" method="POST">
                                                        {% csrf_token %}

                                                        <div class="form-group">
                                                            <label for="address">Address:</label>
                                                            <input type="text" class="form-control" id="address"
                                                                name="address" required>
                                                        </div>

                                                        <div class="form-group">
                                                            <label for="street">Street:</label>
                                                            <input type="text" class="form-control" id="street"
                                                                name="street" required>
                                                        </div>

                                                        <div class="form-group">
                                                            <label for="country">Country:</label>
                                                            <select id="countrySelect" class="form-control"
                                                                onchange="loadStates()" required>
                                                                <option value="" selected disabled>Select Your Country
                                                                </option>
                                                            </select>
                                                            <input type="hidden" name="selectedCountry"
                                                                id="selectedCountryText">
                                                        </div>

                                                        <div class="form-group">
                                                            <label for="state">State:</label>
                                                            <select id="stateSelect" class="form-control"
                                                                onchange="loadCities()" required>
                                                                <option value="" selected disabled>Select Your State
                                                                </option>
                                                            </select>
                                                            <input type="hidden" name="selectedState"
                                                                id="selectedStateText">
                                                        </div>

                                                        <div class="form-group">
                                                            <label for="city">City:</label>
                                                            <select id="citySelect" class="form-control" required>
                                                                <option value="" selected disabled>Select Your City
                                                                </option>
                                                            </select>
                                                            <input type="hidden" name="selectedCity"
                                                                id="selectedCityText">
                                                        </div>

                                                        <div class="form-group">
                                                            <label for="zip_code">Zip Code:</label>
                                                            <input type="text" class="form-control" id="zip_code"
                                                                name="zip_code" placeholder="Optional">
                                                        </div>

                                                        <button type="submit" class="btn btn-primary"
                                                            onclick="loaddata()">Save Address</button>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-dismiss="modal">Close</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="modal fade" id="selAddressModal" tabindex="-1" role="dialog"
                                        aria-labelledby="addAddressModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="addAddressModalLabel">Add New Address
                                                    </h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <select name="" id="modalSelection">
                                                        {% for i in userLocas %}
                                                        <option value="{{i.address_mode}}"
                                                            style="max-width: 200px; flex-wrap: wrap; word-wrap: break-word;">
                                                            {{i.country}}, {{i.state}}, {{i.city}}, &nbsp;
                                                            {{i.street}}, {{i.address}}
                                                        </option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        id="btnModal">Apply</button>
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                                        id="cancelBtn">Cancel</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <script>
                                        var addressText = document.getElementById('addressText');
                                        var btnModal = document.getElementById('btnModal');
                                        var modalSelection = document.getElementById('modalSelection');
                                        btnModal.addEventListener('click', function () {
                                            var data = modalSelection.options[modalSelection.selectedIndex];
                                            addressText.textContent = data.textContent;
                                            if (modalSelection.value > 1) {
                                                document.getElementById('headeraddre').textContent = "New Address";
                                                document.getElementById('userLocaHid').value = modalSelection.value;
                                            } else {
                                                document.getElementById('headeraddre').textContent = "Default Address";
                                                document.getElementById('userLocaHid').value = modalSelection.value;
                                            }
                                            document.getElementById('cancelBtn').click();
                                        });
                                    </script>


                                    <hr class="mb-4">
                                    <h4 class="mb-3">Payment</h4>
                                    <form action="{% url 'successFullOrder'  %}" method="POST">
                                        {% csrf_token %}
                                        <script src="https://checkout.razorpay.com/v1/checkout.js"
                                            data-key="rzp_test_l4eDblehZr7MDi" data-amount="3999900" data-currency="INR"
                                            data-order_id="{{ paymentid }}" data-buttontext="Pay with Razorpay"
                                            data-name="Z Store"
                                            data-description="A Wild Sheep Chase is the third novel by Japanese author Haruki Murakami"
                                            data-image="https://example.com/your_logo.jpg" data-prefill.name="PC"
                                            data-prefill.email="gaurav.kumar@example.com"
                                            data-theme.color="#F37254"></script>
                                        <input type="hidden" custom="Hidden Element" name="hidden" />
                                        <input type="hidden" name="userlocaid" value="{{userloca.id}}">
                                        <input type="hidden" name="useEmail" value="{{request.user.email}}">
                                        <input type="hidden" id="userLocaHid" name="userLocaSize"
                                            value="{{ userloca.address_mode }}">
                                        <input type="hidden" name="productID" value="">
                                        <input type="hidden" name="cartID" value="{{data.id}}">
                                    </form>
                                    <div class="col-sm-6">
                                        <a href="{% url 'index' %}" class="btn btn-link text-muted">
                                            <i class="mdi mdi-arrow-left me-1"></i> Back to Shopping </a>
                                    </div> <!-- end col -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- content-wrapper ends -->
                    <!-- partial:partials/_footer.html -->
                    <!-- partial -->
                </div>
                <!-- main-panel ends -->
            </div>
            <!-- page-body-wrapper ends -->
        </div>
        <!-- container-scroller -->

        <script>
            // Access the data-order_id attribute value
            var orderId = document.querySelector('script[data-order_id]').getAttribute('data-order_id');

            // Log the order ID to the console
            console.log("Order ID: " + orderId);
            // You can now use the orderId variable as needed in your JavaScript code
        </script>
        <script>
            function loaddata() {
                var selectedOption = citySelect.options[citySelect.selectedIndex];
                var selectedOptionText = selectedOption.textContent;
                document.getElementById("selectedCityText").value = selectedOptionText;
                console.log(document.getElementById("selectedCityText").value);
                var selectedOption = stateSelect.options[stateSelect.selectedIndex];
                var selectedOptionText = selectedOption.textContent;
                document.getElementById("selectedStateText").value = selectedOptionText;
                var selectedOption = countrySelect.options[countrySelect.selectedIndex];
                var selectedOptionText = selectedOption.textContent;
                document.getElementById("selectedCountryText").value = selectedOptionText;
            }
        </script>
        <!-- plugins:js -->
        <script src="{% static 'vendors/js/vendor.bundle.base.js' %}"></script>
        <!-- endinject -->
        <!-- Plugin js for this page -->
        <script src="{% static 'vendors/chart.js/Chart.min.js' %}"></script>
        <script src="{% static 'vendors/datatables.net/jquery.dataTables.js' %}"></script>
        <script src="{% static 'vendors/datatables.net-bs4/dataTables.bootstrap4.js' %}"></script>
        <script src="{% static 'js/dataTables.select.min.js' %}"></script>

        <!-- End plugin js for this page -->
        <!-- inject:js -->
        <script src="{% static 'js/off-canvas.js' %}"></script>
        <script src="{% static 'js/hoverable-collapse.js' %}"></script>
        <script src="{% static 'js/template.js' %}"></script>
        <script src="{% static 'js/settings.js' %}"></script>
        <script src="{% static 'js/todolist.js' %}"></script>
        <!-- endinject -->
        <!-- Custom js for this page-->
        <script src="{% static 'js/dashboard.js' %}"></script>
        <script src="{% static 'js/Chart.roundedBarCharts.js' %}"></script>
        <script src="{% static 'productsJS/filtering.js' %}"></script>
        <script src="{% static 'js/purpose build/form_Variables.js' %}"></script>
        <script src="{% static 'js/purpose build/CSC_API.js' %}"></script>
        <!-- End custom js for this page-->
        <script>
            const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
            const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
        </script>
    </body>

</html>