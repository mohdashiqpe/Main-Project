{% extends "../../base.html" %}
{% load static %}
{% block content %}
<section style="background-color: #eee;">
    <div class="container py-5">
        <h3 class="text-info text-center">My Products</h3>
        {% for product in products %}
        <div class="row justify-content-center mb-3">
            <div class="col-md-12 col-xl-10">
                <div class="card shadow-0 border rounded-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-12 col-lg-3 col-xl-3 mb-4 mb-lg-0">
                                <div class="bg-image hover-zoom ripple rounded ripple-surface">
                                    <img src="{{ product.productimages_set.first.images.url }}"
                                        class="w-100" />
                                    <a href="#!">
                                        <div class="hover-overlay">
                                            <div class="mask" style="background-color: rgba(253, 253, 253, 0.15);">
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-6 col-xl-6">
                                <h5>{{ product.name }}</h5>
                                <div class="d-flex flex-row">
                                    <div class="text-danger mb-1 me-2">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                </div>
                                <div class="mt-1 mb-0 text-muted small">
                                    <span class="text-primary"> • </span>
                                    <span>{{product.subcat.name}}</span>
                                    <span class="text-primary"> • </span>
                                    <span>{{ product.brand.name }}</span>
                                </div>
                                <p class="text-truncate mb-4 mb-md-0">
                                    {{product.description}}
                                </p>
                                <p class="text-truncate mb-4 mb-md-0">
                                    <strong>
                                        {% if product.autobidding %}
                                        <li>Auto Bidding</li>
                                        {% else %}
                                        <li>Mannual Bidding</li>
                                        {% endif %}
                                    </strong>
                                </p>
                                <button class="btn btn-inverse-info">Sell for Highest Bid</button>
                            </div>
                            <div class="col-md-6 col-lg-3 col-xl-3 border-sm-start-none border-start">
                                <div class="d-flex flex-row align-items-center mb-1">
                                    <h4 class="mb-1 me-1" id="productprice">{{ product.baseprice }}</h4>
                                </div>
                                <h6 class="text-danger">Current Base Price</h6>
                                <div class="d-flex flex-column mt-4">
                                    <!-- The below Button can be used for accordion -->
                                    <!-- <button class="btn btn-primary btn-sm" type="button"
                                        id="expanddetail">Details</button> -->
                                    {% if product.is_sold %}
                                    <h5>Sold for {{ product.highest_bid }}</h5>
                                    <p style="font-weight: bolder;">Sold to {{product.sold_to.first_name}} {{product.sold_to.last_name}}</p>
                                    {% if product.delivery_chart.deliveryboy %}
                                    <p>Delivery Man: {{ product.delivery_chart.deliveryboy.user_auth.first_name }} {{ product.delivery_chart.deliveryboy.user_auth.last_name }}</p>
                                    {% else %}
                                    <p>Delivery Man: <span style="font-weight: 900;">Not Yet Alloted</span></p>
                                    {% endif %}
                                    {% else %}
                                    <h3 class="text-danger" style="font-family: 'Helvetica Neue'">Not Sold</h3>
                                    <h6>Highest Bid Currently available: <span id="bidprice" class="text-success">{{ product.highest_bid }}</span></h6>
                                    <a href="{% url 'productbidding' %}" class="text-info small-text">Show Biddings</a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- The below can be used in some time -->
                        <!-- <div class="list-group pt-4">
                            <a class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h5 class="mb-1">List group item heading</h5>
                                    <small>3 days ago</small>
                                </div>
                                <p class="mb-1">Some placeholder content in a paragraph.</p>
                                <small>And some small print.</small>
                            </a>
                            <div class="list-group-item ">
                                <div class="d-flex w-100 justify-content-between">
                                    <h5 class="mb-1">List group item heading</h5>
                                    <small class="text-muted">3 days ago</small>
                                </div>
                                <p class="mb-1">Some placeholder content in a paragraph.</p>
                                <small class="text-muted">And some muted small print.</small>
                            </div>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h5 class="mb-1">List group item heading</h5>
                                    <small class="text-muted">3 days ago</small>
                                </div>
                                <p class="mb-1">Some placeholder content in a paragraph.</p>
                                <small class="text-muted">And some muted small print.</small>
                            </a>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        <!-- <div class="row justify-content-center">
            <div class="col-md-12 col-xl-10">
                <div class="card shadow-0 border rounded-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-12 col-lg-3 col-xl-3 mb-4 mb-lg-0">
                                <div class="bg-image hover-zoom ripple rounded ripple-surface">
                                    <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/E-commerce/new/img(5).webp"
                                        class="w-100" />
                                    <a href="#!">
                                        <div class="hover-overlay">
                                            <div class="mask" style="background-color: rgba(253, 253, 253, 0.15);">
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-6 col-xl-6">
                                <h5>Quant ruybi shirts</h5>
                                <div class="d-flex flex-row">
                                    <div class="text-danger mb-1 me-2">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    <span>145</span>
                                </div>
                                <div class="mt-1 mb-0 text-muted small">
                                    <span>100% cotton</span>
                                    <span class="text-primary"> • </span>
                                    <span>Light weight</span>
                                    <span class="text-primary"> • </span>
                                    <span>Best finish<br /></span>
                                </div>
                                <div class="mb-2 text-muted small">
                                    <span>Unique design</span>
                                    <span class="text-primary"> • </span>
                                    <span>For women</span>
                                    <span class="text-primary"> • </span>
                                    <span>Casual<br /></span>
                                </div>
                                <p class="text-truncate mb-4 mb-md-0">
                                    There are many variations of passages of Lorem Ipsum available, but the
                                    majority have suffered alteration in some form, by injected humour, or
                                    randomised words which don't look even slightly believable.
                                </p>
                            </div>
                            <div class="col-md-6 col-lg-3 col-xl-3 border-sm-start-none border-start">
                                <div class="d-flex flex-row align-items-center mb-1">
                                    <h4 class="mb-1 me-1">$17.99</h4>
                                    <span class="text-danger"><s>$25.99</s></span>
                                </div>
                                <h6 class="text-success">Free shipping</h6>
                                <div class="d-flex flex-column mt-4">
                                    <button class="btn btn-primary btn-sm" type="button">Details</button>
                                    <button class="btn btn-outline-primary btn-sm mt-2" type="button">
                                        Add to wishlist
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
    </div>
</section>
<script>
    const expandBtn = document.getElementById('expanddetail');
    const productprice = document.querySelectorAll('#productprice');
    const bidprice = document.querySelectorAll("#bidprice");
    document.addEventListener("DOMContentLoaded", () => {
        productprice.forEach((i) => {
            i.textContent = formatMoney(i.textContent);
        });
        bidprice.forEach((i) => {
            i.textContent = formatMoney(i.textContent);
        });
    });


    function formatMoney(amount) {
        var formattedIncome = new Intl.NumberFormat('en-IN', {
            style: 'currency',
            currency: 'INR' // You can change the currency code as needed
        }).format(Number(amount));
        return formattedIncome;
    }
</script>
{% endblock %}